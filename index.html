<!DOCTYPE html>
<html lang="uz">
<head>
<meta charset="UTF-8" />
<title>Eco Poliz Ekinlari Simulator</title>
<style>
body{margin:0;font-family:'Segoe UI',Arial;background:#2f6b3f;color:#fff;overflow:hidden}
header{padding:14px;text-align:center;font-size:26px;background:rgba(0,0,0,.35)}
#game{display:flex;flex-direction:column;height:100vh}
#mainContent{display:flex;flex:1;overflow:auto}
#left,#right{flex:1;padding:14px;box-sizing:border-box}
.panel{background:rgba(0,0,0,.4);border-radius:16px;padding:12px;margin-bottom:12px}
button{padding:8px 14px;border:none;border-radius:18px;background:linear-gradient(#6adf9b,#2e8b57);color:#fff;font-weight:600;cursor:pointer}
button:hover{filter:brightness(1.1)}
#soil {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(80px, 1fr)); 
  grid-auto-rows: minmax(100px, 1fr); 
  gap: 12px;
}

.cell {
  width: 100%;
  height: 100%;
  background: linear-gradient(#6b3e1e,#4b2a13);
  border-radius: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: calc(1rem + 1vw); 
  cursor: pointer;
  position: relative;
  transition: background 30.0s;
}
.stage{animation:grow .6s ease}
@keyframes grow{from{transform:scale(.5);opacity:0}to{transform:scale(1);opacity:1}}
#shop{position:fixed;inset:0;background:rgba(0,0,0,.75);display:none;align-items:center;justify-content:center; z-index:9999}
#shopBox{width:440px;background:#1e3f2b;border-radius:18px;padding:16px;max-height:80vh;overflow:auto}
.shopItem{display:flex;justify-content:space-between;align-items:center;margin:8px 0;background:rgba(255,255,255,.08);padding:8px;border-radius:12px}
.progress{height:10px;background:#333;border-radius:8px;overflow:hidden}
.progress div{height:100%;background:linear-gradient(#ffd86a,#ff9f1a)}
ul{list-style:none;padding:0;margin:0}
li{padding:4px 0;cursor:pointer}
li:hover{opacity:.8}
#toolbar{position:fixed;bottom:12px;right:12px;background:rgba(0,0,0,0.5);padding:8px;border-radius:12px;display:flex;align-items:center;gap:8px;z-index:999}
#toolbar span{font-weight:bold;margin-left:4px}
</style>
</head>
<body>
<header>ğŸŒ¾ Eco Poliz Ekinlari Simulator</header>
<div id="mainContent">
<div id="left">
<div class="panel">
<h3>ğŸ§  Savol</h3>
<div id="task"></div>
<p id="taskResult"></p>
</div>
<div class="panel">
<h3>ğŸ’ Inventar</h3>
<ul id="inventory"></ul>
</div>
<div class="panel">
<h3>ğŸ“Š Progress</h3>
<p>Level: <span id="level">1</span></p>
<div class="progress"><div id="xpBar" style="width:0%"></div></div>
<p>ğŸ’° Pul: <span id="money">0</span></p>
<button id="shopBtn">ğŸ›’ Magazin</button>
</div>
</div>
<div id="right">
<div class="panel">
<h3>ğŸŒ± 133-IDUM Issiqxona</h3>
<div id="soil"></div>
</div>
</div>
</div>

<div id="shop">
<div id="shopBox">
<h3>ğŸ›’ Magazin</h3>
<div id="shopItems"></div>
<button id="closeShop">Yopish</button>
</div>
</div>

<div id="toolbar">
<button id="useHoe">ğŸª“ Belkurak</button><span id="hoeCount">0</span>
<button id="useFertilizer">ğŸ§ª Oâ€˜gâ€˜it</button><span id="fertCount">0</span>
</div>

<script>
'use strict';

/* ===== DOM ===== */
const soilEl = document.getElementById('soil');
const taskEl = document.getElementById('task');
const taskResultEl = document.getElementById('taskResult');
const moneyEl = document.getElementById('money');
const levelEl = document.getElementById('level');
const xpBar = document.getElementById('xpBar');
const shopEl = document.getElementById('shop');
const shopItemsEl = document.getElementById('shopItems');
const inventoryEl = document.getElementById('inventory');
const useHoeBtn = document.getElementById('useHoe');
const useFertilizerBtn = document.getElementById('useFertilizer');
const hoeCountEl = document.getElementById('hoeCount');
const fertCountEl = document.getElementById('fertCount');

document.getElementById('shopBtn').addEventListener('click',openShop);
document.getElementById('closeShop').addEventListener('click',closeShop);

/* ===== STATE ===== */
let money = 0;
let level = 1;
let xp = 0;
let selectedSeed = null;
let inventory = [];
let ownedBackgrounds = ['default'];
let tools = {hoe:0, fertilizer:0};

/* ===== SEEDS ===== */
const seeds = [
 {name:'Sabzi', stages:['ğŸŒ°','ğŸŒ±','ğŸ¥•'], water:3, profit:20, price:5},
 {name:'Qovoq', stages:['ğŸŒ°','ğŸŒ¿','ğŸƒ'], water:4, profit:30, price:8},
 {name:'Kartoshka', stages:['ğŸŒ°','ğŸŒ±','ğŸ¥”'], water:3, profit:25, price:6},
 {name:'Qulupnay', stages:['ğŸŒ°','ğŸŒ¿','ğŸ“'], water:4, profit:35, price:10},
 {name:'Makkajoâ€˜xori', stages:['ğŸŒ°','ğŸŒ±','ğŸŒ½'], water:5, profit:40, price:12},
 {name:'Pomidor', stages:['ğŸŒ°','ğŸŒ±','ğŸ…'], water:3, profit:28, price:7},
 {name:'Bodring', stages:['ğŸŒ°','ğŸŒ¿','ğŸ¥’'], water:3, profit:26, price:6},
 {name:'Baqlajon', stages:['ğŸŒ°','ğŸŒ±','ğŸ†'], water:4, profit:34, price:9},
 {name:'Qalampir', stages:['ğŸŒ°','ğŸŒ±','ğŸ«‘'], water:3, profit:30, price:8},
 {name:'Piyoz', stages:['ğŸŒ°','ğŸŒ±','ğŸ§…'], water:2, profit:18, price:4},
 {name:'Sarimsoq', stages:['ğŸŒ°','ğŸŒ±','ğŸ§„'], water:2, profit:22, price:5},
 {name:'Tarvuz', stages:['ğŸŒ°','ğŸŒ¿','ğŸ‰'], water:5, profit:60, price:15},
 {name:'Qovun', stages:['ğŸŒ°','ğŸŒ¿','ğŸˆ'], water:5, profit:55, price:14},
 {name:'Golden Sabzi', stages:['ğŸŒ°','ğŸŒ±','ğŸ¥•'], water:2, profit:60, price:20},
 {name:'Diamond Qovoq', stages:['ğŸŒ°','ğŸŒ¿','ğŸƒ'], water:3, profit:80, price:25}
];

/* ===== SOIL ===== */
const cells = [];
function initSoil(){
 soilEl.innerHTML='';
 for(let i=0;i<12;i++){
  cells[i]={seed:null,water:0,alive:true};
  const c=document.createElement('div');
  c.className='cell';
  c.addEventListener('click',()=>interact(i,c));
  soilEl.appendChild(c);
 }
}

/* ===== Oâ€˜SIMLIK INTERAKSIYASI ===== */
function interact(i,c){
 const d=cells[i];
 if(!d.seed){
   if(!selectedSeed) return;
   d.seed = JSON.parse(JSON.stringify(selectedSeed));
   d.water = 0;
   d.alive = true;
   inventory.splice(selectedSeed._invIndex,1);
   selectedSeed = null;
   draw(c,d);
   updateUI();
   return;
 }

 // Agar oâ€˜gâ€˜it ishlatilsa
 if(selectedSeed && selectedSeed.effect==='fertilize'){
   if(d.seed && d.alive){
     d.water = d.seed.water;
     draw(c,d);
     tools.fertilizer--;
     updateToolbar();
     selectedSeed=null;
   }
   return;
 }

 // Agar belkurak ishlatilsa
 if(selectedSeed && selectedSeed.effect==='hoe'){
   if(d.seed){
     d.seed=null;
     d.water=0;
     d.alive=true;
     draw(c,d);
     tools.hoe--;
     updateToolbar();
     selectedSeed=null;
   }
   return;
 }

 // Oddiy sugâ€˜orish
 if(d.alive) d.water++;
 draw(c,d);
 if(d.water>=d.seed.water){
  money+=d.seed.profit;
  addXP(20);
  cells[i]={seed:null,water:0,alive:true};
  setTimeout(()=>c.innerHTML='',300);
 }
 updateUI();
}

/* ===== DRAW ===== */
function draw(c,d){
 if(!d.seed) {c.innerHTML=''; c.style.background='linear-gradient(#6b3e1e,#4b2a13)'; return;}
 if(!d.alive) {c.innerHTML='â˜ ï¸'; return;}
 const stage=Math.min(d.water,d.seed.stages.length-1);
 c.innerHTML='<span class="stage">'+d.seed.stages[stage]+'</span>';
}

/* ===== TIME UPDATE ===== */
setInterval(()=>{
 cells.forEach(c=>{
   if(c.seed && c.alive){
     c.water--;
     if(c.water<0) c.alive=false;
   }
 });
 [...soilEl.children].forEach((el,i)=>draw(el,cells[i]));
},5000);

/* ===== XP ===== */
function addXP(v){
 xp+=v;
 const need=level*100;
 if(xp>=need){xp-=need;level++;}
 xpBar.style.width=(xp/(level*100)*100)+'%';
 levelEl.textContent=level;
}

/* ===== UI ===== */
function updateUI(){
 moneyEl.textContent=money;
 inventoryEl.innerHTML='';
 inventory.forEach((s,i)=>{
   const li = document.createElement('li');
   li.textContent=s.stages?'ğŸŒ± '+s.name:s.name;
   li.dataset.i=i;
   li.addEventListener('click',()=>selectFromInv(i));
   inventoryEl.appendChild(li);
 });
 updateToolbar();
}

function selectFromInv(i){
 if(selectedSeed){alert("âš ï¸ Avval tanlangan elementni ishlating!"); return;}
 selectedSeed=inventory[i];
 selectedSeed._invIndex=i;
}

function updateToolbar(){
 hoeCountEl.textContent = tools.hoe;
 fertCountEl.textContent = tools.fertilizer;
}

/* ===== QUESTIONS ===== */
const questions=[
 {q:'5 Ã— 6 = ?',a:'30'},{q:'7 Ã— 8 = ?',a:'56'},{q:'9 Ã— 9 = ?',a:'81'},
 {q:'12 + 18 = ?',a:'30'},{q:'45 - 17 = ?',a:'28'},
 {q:'Plastik necha yilda yoâ€˜qoladi?',a:'100'},
 {q:'Qaysi energiya qayta tiklanadi?',a:'quyosh'},
 {q:'Daraxtlar nimani yutadi?',a:'co2'},
 {q:'8 Ã— 7 = ?',a:'56'},{q:'6 Ã— 9 = ?',a:'54'},
 {q:'20 + 35 = ?',a:'55'},{q:'100 - 47 = ?',a:'53'},
 {q:'3 Ã— 12 = ?',a:'36'},{q:'11 Ã— 11 = ?',a:'121'},
 {q:'15 + 27 = ?',a:'42'},{q:'50 - 19 = ?',a:'31'},
 {q:'4 Ã— 14 = ?',a:'56'},{q:'9 Ã— 6 = ?',a:'54'},
 {q:'70 - 28 = ?',a:'42'},{q:'8 Ã— 12 = ?',a:'96'},
 {q:'6 Ã— 11 = ?',a:'66'},{q:'90 - 33 = ?',a:'57'},
 {q:'Suvni tejash kerakmi?',a:'ha'},
 {q:'Chiqindi ajratish foydalimi?',a:'ha'},
 {q:'Ekologiya nimani oâ€˜rganadi?',a:'tabiat'},
 {q:'Qogâ€˜oz qayerdan olinadi?',a:'daraxt'},
 {q:'Organik chiqindi nima?',a:'oziq'},
 {q:'Energiya tejash muhimmi?',a:'ha'},
 {q:'Suvsiz oâ€˜simlik yashaydimi?',a:'yoq'}
];

function newTask(){
 const t=questions[Math.floor(Math.random()*questions.length)];
 taskEl.innerHTML=t.q+'<br><input id="ans"><button id="okBtn">OK</button>';
 document.getElementById('okBtn').addEventListener('click',()=>check(t.a));
}
function check(a){
 const input=document.getElementById('ans');
 if(!input) return;
 const v=input.value.toLowerCase().trim();
 if(v===a){
  const seed=JSON.parse(JSON.stringify(seeds[Math.floor(Math.random()*seeds.length)]));
  inventory.push(seed);
  taskResultEl.textContent='ğŸŒ± Urugâ€˜ olding: '+seed.name;
  updateUI();
 } else taskResultEl.textContent='âŒ Notoâ€˜gâ€˜ri javob';
 newTask();
}

/* ===== SHOP ===== */
function openShop(){
 shopEl.style.display='flex';
 shopItemsEl.innerHTML='<h4>ğŸŒ± Urugâ€˜lar</h4>';
 seeds.forEach(s=>{
  const d=document.createElement('div');
  d.className='shopItem';
  d.innerHTML='<span>'+s.name+'</span>';
  const b=document.createElement('button');
  b.textContent=s.price+' ğŸ’°';
  b.addEventListener('click',()=>buySeed(s));
  d.appendChild(b);
  shopItemsEl.appendChild(d);
 });
const h2 = document.createElement('h4');
h2.textContent='ğŸ›  Vositalar';
shopItemsEl.appendChild(h2);
[ {name:'ğŸª“ Belkurak',type:'hoe',price:10},{name:'ğŸ§ª Oâ€˜gâ€˜it',type:'fertilizer',price:20}].forEach(t=>{
 const d=document.createElement('div');
 d.className='shopItem';
 d.innerHTML='<span>'+t.name+'</span>';
 const b=document.createElement('button');
 b.textContent=t.price+' ğŸ’°';
 b.addEventListener('click',()=>buyTool(t));
 d.appendChild(b);
 shopItemsEl.appendChild(d);
});

const h3 = document.createElement('h4');
h3.textContent='ğŸ¨ Fonlar';
shopItemsEl.appendChild(h3);
const backgrounds=[
  {id:'forest',name:'Oâ€˜rmon',price:3000,color:'#245c3a'},
  {id:'sunset',name:'Quyosh botishi',price:4000,color:'#6b3e2e'},
  {id:'night',name:'Tun',price:5000,color:'#1b1f3b'}
];
backgrounds.forEach(bg=>{
 const d=document.createElement('div');
 d.className='shopItem';
 d.innerHTML='<span>'+bg.name+'</span>';
 const b=document.createElement('button');
 const owned=ownedBackgrounds.includes(bg.id);
 b.textContent=owned?'Sotib olingan':bg.price+' ğŸ’°';
 b.disabled=owned;
 b.addEventListener('click',()=>buyBackground(bg));
 d.appendChild(b);
 shopItemsEl.appendChild(d);
});
}

function closeShop(){shopEl.style.display='none';}

function buySeed(s){
  if(money < s.price){
    alert('Pul yetarli emas');
    return;
  }
  money -= s.price;
  inventory.push(JSON.parse(JSON.stringify(s)));
  updateUI();
  openShop(); // magazin qayta ochilib, tugmalar yangilanadi
}

function buyTool(t){
  if(money < t.price){
    alert('Pul yetarli emas');
    return;
  }
  money -= t.price;
  tools[t.type]++;
  updateToolbar();
  updateUI();
  openShop(); // tugmalar yangilansin
}

function buyBackground(bg){
  if(money < bg.price){
    alert('Pul yetarli emas');
    return;
  }
  money -= bg.price;
  ownedBackgrounds.push(bg.id);
  document.body.style.background=bg.color;
  updateUI();
  openShop();
}

/* ===== TOOL BUTTONS ===== */
useHoeBtn.addEventListener('click',()=>{
 if(tools.hoe>0){
   selectedSeed={effect:'hoe'};
 } else alert('Belkurak yoâ€˜q!');
});
useFertilizerBtn.addEventListener('click',()=>{
 if(tools.fertilizer>0){
   selectedSeed={effect:'fertilize'};
 } else alert('Oâ€˜gâ€˜it yoâ€˜q!');
});

/* ===== START ===== */
initSoil();
updateUI();
newTask();
</script>
</body>
</html>


